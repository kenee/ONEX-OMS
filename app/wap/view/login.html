<!--
  Copyright 2012-2026 ShopeX (https://www.shopex.cn)

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
  
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="renderer" content="webkit">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta name="author" content="tyler chao">
  <meta name="keywords" content="keywords">
  <meta name="description" content="description">
  <title>门店自提管理</title>
  <link rel="stylesheet" href="<{$env.app.res_url}>/css/mobile.min.css">
  <link rel="stylesheet" href="<{$env.app.res_url}>/css/main.min.css">
  <style>
    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: #f5f7fa;
      color: #303133;
      overflow: hidden;
    }
    body {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      position: relative;
      background: #f5f7fa url('<{$env.CONF.ROOT_DIR}>/app/desktop/statics/perfect/login-bg.jpg') center / cover no-repeat fixed;
    }
    #main.login-layer {
      width: 100%;
      max-width: 480px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      padding: 40px 35px;
    }
    .logo {
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
      margin-bottom: 28px;
    }
    .logo img {
      display: block;
      margin: 0 auto !important;
      max-width: 280px;
      height: auto;
    }
    .form {
      width: 100%;
    }
    .form .no-bullet {
      list-style: none;
      margin: 0;
      padding: 0;
    }
    .form-row { margin-bottom: 20px; }
    .grid-1, .grid-3 { width: 100%; }
    .form-row i { display: none; }
    input[type="text"],
    input[type="password"],
    .inputstyle-short-out {
      width: 100%;
      height: 42px;
      padding: 0 14px;
      border: 1px solid #e8e8e8;
      border-radius: 6px;
      font-size: 14px;
      background: #fff;
      color: #303133;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    input[type="text"]:focus,
    input[type="password"]:focus,
    .inputstyle-short-out:focus {
      outline: none;
      border-color: #157FE3;
      box-shadow: 0 0 0 2px rgba(21,127,227,0.12);
    }
    .inputstyle-short-out { padding-left: 10px; }
    /* 强制覆盖 mobile.css/main.css 中的 .btn.primary/button.primary */
    .but_login,
    .btn.primary.but_login,
    button.primary.but_login {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: auto;
      min-width: 140px;
      height: auto;
      padding: 14px 40px;
      background: #000 !important;
      color: #fff !important;
      border: none !important;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      letter-spacing: 1px;
      line-height: 1.5;
      margin: 0 0 0 auto;
      box-shadow: none !important;
    }
    .but_login:hover,
    .btn.primary.but_login:hover,
    button.primary.but_login:hover { background: #333 !important; }
    .but_login:active,
    .btn.primary.but_login:active,
    button.primary.but_login:active { background: #000 !important; transform: translateY(1px); }
    .form-row .grid-1 {
      display: flex;
      justify-content: flex-end;
      align-items: center;
    }
    .alert-box { display: none; font-size: 12px; color: #f56c6c; margin-top: 6px; }
    .form-row.has-error .alert-box { display: block; }
    .verifycodeimg {
      height: 44px;
      border: 1px solid #dcdfe6;
      border-radius: 6px;
      vertical-align: middle;
    }
    .form-row .grid-3 {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .form-row .grid-3:first-child { max-width: 120px; }
    .form-row .grid-3:last-child { flex: 1; }
    .form-row .grid-3 a {
      color: #157FE3;
      text-decoration: none;
      font-size: 13px;
    }
    .form-row .grid-3 a:hover { opacity: 0.85; }
    .footer {
      position: fixed;
      left: 0; right: 0; bottom: 0;
      text-align: center;
      padding: 14px 0;
      color: #999;
      font-size: 12px;
      background: transparent;
      pointer-events: none;
    }
    .footer .footer-text {
      pointer-events: auto;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .footer img { height: 16px; vertical-align: middle; }
  </style>
</head>
<body>
<main id="main" class="login-layer">
  <div class="logo"><img src="<{$env.CONF.ROOT_DIR}>/app/desktop/statics/logo.png" alt=""></div>
  <form action="<{$redirect_url}>" method="post" class="form" data-validator="ajax">
    <ul class="no-bullet">
      <li class="form-row">
        <div class="grid-1">
          <i class="icon-user"></i>
          <input type="text" name="uname" id="uname" required placeholder="请输入用户名">
          <span class="alert-box error">用户名必填</span>
        </div>
      </li>
      <li class="form-row">
        <div class="grid-1">
          <i class="icon-lock"></i>
          <input type="password" name="password" id="password" required placeholder="请输入密码">
          <span class="alert-box error">密码必填</span>
        </div>
      </li>
      
      <{if $show_varycode}>
      <li class="form-row">
         <div class="grid-3" style="width:25%;"><input maxlength="4" autocomplete="off" class="inputstyle-short-out" name="verifycode" id="verifycode" value="" style="padding-left:0px;"  /></div>
         <div class="grid-3" style="width:70%; padding-left:10px;"><img id="shopadminvocde" src="<{$desktop_url}>index.php?app=wap&ctl=passport&act=gen_vcode&<{$smarty.now}>" class="verifycodeimg" style="height:40px;margin-top:3px;"><a href="javascript:changeimg('shopadminvocode')" style="padding-left:5px;font-size:14px;"><{t}>点击刷新<{/t}></a></div>
      </li>
      <{/if }>
      
      <li class="form-row">
        <div class="grid-1"><button type="submit" class="primary expand but_login">登录</button></div>
        <div class="grid-1"></div>
      </li>
    </ul>
  </form>
</main>

<footer id="footer" class="footer fixed bottom text-center">
  <span class="footer-text">
    Powered by
    <a href="https://shopex.cn" target="_blank"><img src="<{$env.CONF.ROOT_DIR}>/app/desktop/statics/mini-logo.png" alt="oneX OMS Logo" /></a>
  </span>
</footer>

<script src="<{$env.app.res_url}>/js/libs.min.js"></script>
<script src="<{$env.app.res_url}>/js/mobile.min.js"></script>
<script src="<{$env.app.res_url}>/js/main.min.js"></script>

<script>
var ck = function(key){
    this.key = key;
    this.options = {
        path: '/',
        domain: false,
        duration: 30,
        secure: false,
        document: document,
        encode: true
    };
};
ck.prototype = {
    w:function(value){
            if (this.options.encode) value = encodeURIComponent(value);
            if (this.options.domain) value += '; domain=' + this.options.domain;
            if (this.options.path) value += '; path=' + this.options.path;
            if (this.options.duration){
                var date = new Date();
                date.setTime(date.getTime() + this.options.duration * 24 * 60 * 60 * 1000);
                value += '; expires=' + date.toGMTString();
            }
            if (this.options.secure) value += '; secure';
            this.options.document.cookie = this.key + '=' + value;
    },
    r:function(){
            var value = this.options.document.cookie.match('(?:^|;)\\s*' + this.key + '=([^;]*)');
            return (value) ? decodeURIComponent(value[1]) : null;
    }
};
var cukie = {
    w:function(k,v){
        var ins = new ck(k);
        ins.w(v);
    },
    r:function(k){
        var ins = new ck(k);
        return ins.r();
    },
    d:function(k){
        var ins = new ck(k);
        ins.options.duration = -1;
        ins.w('');
    }
};

$(function() {
    
    $('.but_login').on('click', function(e) {
        var autologin = document.getElementById('autologin');
        
        if(autologin.checked){
            cukie.w('autologin', 30*1440);
        }else{
            cukie.d('autologin');
        }
    });
    
    var showVarycode = '<{$show_varycode|default:"false"}>' === 'true';
    if (showVarycode) {
        changeimg = function(id){
            var timestamp = Date.parse(new Date());
            document.getElementById('shopadminvocde').src='<{$desktop_url}>index.php?app=wap&ctl=passport&act=gen_vcode#'+timestamp;
        };
    }
});
</script>

</body>
</html>